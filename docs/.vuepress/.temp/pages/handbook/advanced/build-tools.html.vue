<template
  ><h1 id="构建工具" tabindex="-1"
    ><a class="header-anchor" href="#构建工具" aria-hidden="true">#</a> 构建工具</h1
  >
  <p
    ><code>create-project</code> 创建的项目，在构建工具方面，支持以 <code>webpack</code> 为代表的
    bundle 工具。同时也支持最近这两年比较流行的，基于 ES module 的 bundleless 工具，以
    <code>vite</code> 为代表。</p
  >
  <p>下面来介绍下，这两种构建工具在项目模板具体的一些使用特性。</p>
  <h2 id="bundle" tabindex="-1"
    ><a class="header-anchor" href="#bundle" aria-hidden="true">#</a> bundle</h2
  >
  <p
    >是基于官方提供的命令行工具
    <a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener noreferrer"
      >vue-cli<ExternalLinkIcon
    /></a>
    进行搭建的。参考了里面的一些配置，并在
    <code>vue.config.js</code> 文件里扩展了一些常用的功能。</p
  >
  <h3 id="vue-config-js-基础配置" tabindex="-1"
    ><a class="header-anchor" href="#vue-config-js-基础配置" aria-hidden="true">#</a> vue.config.js
    基础配置</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">/**</span></span>
<span class="line"><span style="color: #6A9955">   * You can set by yourself according to actual condition</span></span>
<span class="line"><span style="color: #6A9955">   * You will need to set this if you plan to deploy your site under a sub path,</span></span>
<span class="line"><span style="color: #6A9955">   * for example GitHub pages. If you plan to deploy your site to https://foo.github.io/bar/,</span></span>
<span class="line"><span style="color: #6A9955">   * then assetsPublicPath should be set to &quot;/bar/&quot;.</span></span>
<span class="line"><span style="color: #6A9955">   * In most cases please use &#39;/&#39; !!!</span></span>
<span class="line"><span style="color: #6A9955">   * Detail https://cli.vuejs.org/config/#publicPath</span></span>
<span class="line"><span style="color: #6A9955">   */</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">publicPath:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">assetsDir:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;static&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">lintOnSave:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">.</span><span style="color: #4FC1FF">NODE_ENV</span><span style="color: #D4D4D4"> !== </span><span style="color: #CE9178">&#39;production&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">productionSourceMap:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">pluginOptions:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">lintStyleOnBuild:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">stylelint:</span><span style="color: #D4D4D4"> {}</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// disable thread-loader, which is not compactible with this plugin</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">parallel:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span
      ><br /></div></div
  ><h3 id="proxy-解决接口跨域问题" tabindex="-1"
    ><a class="header-anchor" href="#proxy-解决接口跨域问题" aria-hidden="true">#</a> proxy
    解决接口跨域问题</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// webpack-dev-server 相关配置</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">devServer:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">port:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">3000</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">https:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">client:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">overlay:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">warnings:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">errors:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    },</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 代理示例 https://webpack.docschina.org/configuration/dev-server/#devserver-proxy</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">proxy:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #CE9178">&#39;/api&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">target:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;http://localhost:8000&#39;</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 后端接口地址</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">ws:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">changeOrigin:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 是否允许跨域</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">pathRewrite:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #CE9178">&#39;^/api&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;&#39;</span><span style="color: #D4D4D4">   </span><span style="color: #6A9955">// 直接用&#39;api/接口名&#39;进行请求.</span></span>
<span class="line"><span style="color: #D4D4D4">        }</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span
      ><br /></div></div
  ><p>使用示例：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #808080">&lt;</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span>
<span class="line"><span style="color: #D4D4D4">    import axios from &quot;axios&quot;;</span></span>
<span class="line"><span style="color: #D4D4D4">    axios.get(&quot;/api/getPetId&quot;).then(res =&gt; </span><span style="color: #569CD6">{</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">console</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">log</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;getPetId:&#39;</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">res</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">}</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #808080">&lt;/</span><span style="color: #569CD6">script</span><span style="color: #808080">&gt;</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /></div></div
  ><h3 id="添加别名-alias" tabindex="-1"
    ><a class="header-anchor" href="#添加别名-alias" aria-hidden="true">#</a> 添加别名 alias</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">path</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;path&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">pkg</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;./package.json&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4"> = (</span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">join</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">__dirname</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&#39;./&#39;</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">configureWebpack</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">`</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">pkg</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">name</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">resolve:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">alias:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@assets&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/assets&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@style&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/assets/style&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@js&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/assets/js&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@components&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/components&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@mixins&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/mixins&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@filters&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/filters&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@store&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/store&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #CE9178">&#39;@views&#39;</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/views&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 文件别名</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">services:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/services&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">variable:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/assets/style/variable.less&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">utils:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;node_modules/@winner-fed/cloud-utils/dist/cloud-utils.esm&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">mixins:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;node_modules/@winner-fed/magicless/magicless.less&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }),</span></span>
<span class="line"><span style="color: #D4D4D4">});</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /></div></div
  ><h4 id="支持-svg-组件" tabindex="-1"
    ><a class="header-anchor" href="#支持-svg-组件" aria-hidden="true">#</a> 支持 SVG 组件</h4
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">chainWebpack</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// module</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// svg</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// exclude icons</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">module</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">rule</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;svg&#39;</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #9CDCFE">exclude</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">add</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/icons&#39;</span><span style="color: #D4D4D4">))</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">end</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">module</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">rule</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;icons&#39;</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">(</span><span style="color: #D16969">/</span><span style="color: #D7BA7D">\.</span><span style="color: #D16969">svg</span><span style="color: #DCDCAA">$</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #9CDCFE">include</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">add</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/icons&#39;</span><span style="color: #D4D4D4">))</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">end</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">use</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;svg-sprite-loader&#39;</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">loader</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;svg-sprite-loader&#39;</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">options</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">symbolId:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;icon-[name]&#39;</span></span>
<span class="line"><span style="color: #D4D4D4">      })</span></span>
<span class="line"><span style="color: #D4D4D4">      .</span><span style="color: #DCDCAA">end</span><span style="color: #D4D4D4">();</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /></div></div
  ><h3 id="使用-splitchunks-单独打包三方依赖模块" tabindex="-1"
    ><a class="header-anchor" href="#使用-splitchunks-单独打包三方依赖模块" aria-hidden="true">#</a>
    使用 splitChunks 单独打包三方依赖模块</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">chainWebpack</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// optimization</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">config</span></span>
<span class="line"><span style="color: #D4D4D4">  .</span><span style="color: #DCDCAA">when</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">.</span><span style="color: #4FC1FF">NODE_ENV</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">&#39;production&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">config</span></span>
<span class="line"><span style="color: #D4D4D4">        .</span><span style="color: #9CDCFE">optimization</span></span>
<span class="line"><span style="color: #D4D4D4">        .</span><span style="color: #DCDCAA">splitChunks</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">chunks:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;all&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">cacheGroups:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">defaultVendors:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;chunk-vendors&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">test:</span><span style="color: #D16969"> /</span><span style="color: #CE9178">[</span><span style="color: #D7BA7D">\\</span><span style="color: #D16969">/</span><span style="color: #CE9178">]</span><span style="color: #D16969">node_modules</span><span style="color: #CE9178">[</span><span style="color: #D7BA7D">\\</span><span style="color: #D16969">/</span><span style="color: #CE9178">]</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">priority:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">chunks:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;initial&#39;</span><span style="color: #D4D4D4"> </span><span style="color: #6A9955">// 只打包初始时依赖的第三方</span></span>
<span class="line"><span style="color: #D4D4D4">            },</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">commons:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">name:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;chunk-commons&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">test:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;src/components&#39;</span><span style="color: #D4D4D4">), </span><span style="color: #6A9955">// 可自定义拓展你的规则</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">minChunks:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">3</span><span style="color: #D4D4D4">, </span><span style="color: #6A9955">// 最小公用次数</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">priority:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">5</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">reuseExistingChunk:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span></span>
<span class="line"><span style="color: #D4D4D4">            }</span></span>
<span class="line"><span style="color: #D4D4D4">          }</span></span>
<span class="line"><span style="color: #D4D4D4">        });</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">config</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">optimization</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">runtimeChunk</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;single&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">    });</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span
      ><br /></div></div
  ><h3 id="css-相关配置及-less-全局注入变量及函数" tabindex="-1"
    ><a class="header-anchor" href="#css-相关配置及-less-全局注入变量及函数" aria-hidden="true"
      >#</a
    >
    CSS 相关配置及 Less 全局注入变量及函数</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// css相关配置</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">css:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 是否使用css分离插件 ExtractTextPlugin</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">extract:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4">() ? </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 开启 CSS source maps?</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">sourceMap:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4">() ? </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4"> : </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// css预设器配置项</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">loaderOptions:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">less:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// 全局注入变量及mixins</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">additionalData:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">`@import &quot;@/assets/style/variable.less&quot;;@import &quot;@winner-fed/magicless/magicless.less&quot;;`</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /></div></div
  ><h3 id="生产环境移除-console-log" tabindex="-1"
    ><a class="header-anchor" href="#生产环境移除-console-log" aria-hidden="true">#</a> 生产环境移除
    console.log</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">TerserPlugin</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;terser-webpack-plugin&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">.</span><span style="color: #4FC1FF">NODE_ENV</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">&#39;production&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"><span style="color: #6A9955">// 生产环境去掉 console.log</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getOptimization</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">let</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">optimization</span><span style="color: #D4D4D4"> = {};</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4">()) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">optimization</span><span style="color: #D4D4D4"> = {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// https://webpack.docschina.org/configuration/optimization/#optimization-minimizer</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">minimizer:</span><span style="color: #D4D4D4"> [</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">TerserPlugin</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">terserOptions:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// https://github.com/webpack-contrib/terser-webpack-plugin#terseroptions</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #9CDCFE">compress:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">warnings:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">drop_console:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">drop_debugger:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">pure_funcs:</span><span style="color: #D4D4D4"> [</span><span style="color: #CE9178">&#39;console.log&#39;</span><span style="color: #D4D4D4">]</span></span>
<span class="line"><span style="color: #D4D4D4">            }</span></span>
<span class="line"><span style="color: #D4D4D4">          }</span></span>
<span class="line"><span style="color: #D4D4D4">        })</span></span>
<span class="line"><span style="color: #D4D4D4">      ]</span></span>
<span class="line"><span style="color: #D4D4D4">    };</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">optimization</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">configureWebpack</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// https://github.com/cklwblove/vue-cli3-template/issues/12</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">optimization:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">getOptimization</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #D4D4D4">  })</span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span><br /><span
        class="line-number"
        >33</span
      ><br /><span class="line-number">34</span><br /><span class="line-number">35</span><br /><span
        class="line-number"
        >36</span
      ><br /></div></div
  ><h3 id="支持-gzip-压缩" tabindex="-1"
    ><a class="header-anchor" href="#支持-gzip-压缩" aria-hidden="true">#</a> 支持 gzip 压缩</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">webpack</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;webpack&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">pkg</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;./package.json&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">formatDate</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@winner-fed/cloud-utils&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">AddAssetHtmlPlugin</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;add-asset-html-webpack-plugin&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">WebpackBar</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;webpackbar&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">CompressionWebpackPlugin</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;compression-webpack-plugin&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">.</span><span style="color: #4FC1FF">NODE_ENV</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">&#39;production&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">genPlugins</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">plugins</span><span style="color: #D4D4D4"> = [</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">WebpackBar</span><span style="color: #D4D4D4">(),</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// 为静态资源文件添加 hash，防止缓存</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">AddAssetHtmlPlugin</span><span style="color: #D4D4D4">([</span></span>
<span class="line"><span style="color: #D4D4D4">      {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">filepath:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">__dirname</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&#39;./public/console.js&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">hash:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    ])</span></span>
<span class="line"><span style="color: #D4D4D4">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4">()) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// bannerPlugin</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">webpack</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">BannerPlugin</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">banner:</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #CE9178">`@author: Whale FE</span><span style="color: #569CD6">${</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #4FC1FF">N</span><span style="color: #569CD6">}</span><span style="color: #CE9178">@version: </span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">pkg</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">version</span><span style="color: #569CD6">}${</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #4FC1FF">N</span><span style="color: #569CD6">}</span><span style="color: #CE9178">@description: Build time </span><span style="color: #569CD6">${</span><span style="color: #DCDCAA">formatDate</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">Date</span><span style="color: #D4D4D4">(), </span><span style="color: #CE9178">&#39;yyyy-MM-dd HH:mm:ss&#39;</span><span style="color: #D4D4D4">)</span><span style="color: #569CD6">}</span><span style="color: #CE9178">          `</span></span>
<span class="line"><span style="color: #D4D4D4">      }),</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">CompressionWebpackPlugin</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">filename:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;[path][base].gz[query]&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">algorithm:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;gzip&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">test:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">RegExp</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #CE9178">&#39;</span><span style="color: #D7BA7D">\\</span><span style="color: #CE9178">.(&#39;</span><span style="color: #D4D4D4"> +</span></span>
<span class="line"><span style="color: #D4D4D4">          [</span><span style="color: #CE9178">&#39;js&#39;</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&#39;css&#39;</span><span style="color: #D4D4D4">].</span><span style="color: #DCDCAA">join</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;|&#39;</span><span style="color: #D4D4D4">) +</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #CE9178">&#39;)$&#39;</span></span>
<span class="line"><span style="color: #D4D4D4">        ),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">threshold:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">10240</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">minRatio:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">0.8</span></span>
<span class="line"><span style="color: #D4D4D4">      })</span></span>
<span class="line"><span style="color: #D4D4D4">    );</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">configureWebpack</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">genPlugins</span><span style="color: #D4D4D4">(),</span></span>
<span class="line"><span style="color: #D4D4D4">  }) </span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span><br /><span
        class="line-number"
        >33</span
      ><br /><span class="line-number">34</span><br /><span class="line-number">35</span><br /><span
        class="line-number"
        >36</span
      ><br /><span class="line-number">37</span><br /><span class="line-number">38</span><br /><span
        class="line-number"
        >39</span
      ><br /><span class="line-number">40</span><br /><span class="line-number">41</span><br /><span
        class="line-number"
        >42</span
      ><br /><span class="line-number">43</span><br /><span class="line-number">44</span><br /><span
        class="line-number"
        >45</span
      ><br /><span class="line-number">46</span><br /><span class="line-number">47</span><br /><span
        class="line-number"
        >48</span
      ><br /><span class="line-number">49</span><br /><span class="line-number">50</span><br /><span
        class="line-number"
        >51</span
      ><br /><span class="line-number">52</span><br /><span class="line-number">53</span><br /><span
        class="line-number"
        >54</span
      ><br /><span class="line-number">55</span><br /></div></div
  ><h3 id="生成-manifest-json" tabindex="-1"
    ><a class="header-anchor" href="#生成-manifest-json" aria-hidden="true">#</a> 生成
    manifest.json</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">path</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;path&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">pkg</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;./package.json&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">WebpackManifestPlugin</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;webpack-manifest-plugin&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">.</span><span style="color: #4FC1FF">NODE_ENV</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">&#39;production&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">genPlugins</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">plugins</span><span style="color: #D4D4D4"> = [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4">()) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">WebpackManifestPlugin</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">fileName:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">__dirname</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #CE9178">&#39;dist&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #CE9178">`manifest.</span><span style="color: #569CD6">${</span><span style="color: #4EC9B0">Date</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">now</span><span style="color: #D4D4D4">()</span><span style="color: #569CD6">}</span><span style="color: #CE9178">.json`</span></span>
<span class="line"><span style="color: #D4D4D4">        ),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">filter</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> ({</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">}) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> !</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;runtime&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">generate</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">seed</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">files</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">entries</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">files</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">reduce</span><span style="color: #D4D4D4">((</span><span style="color: #9CDCFE">manifest</span><span style="color: #D4D4D4">, {</span><span style="color: #9CDCFE">name</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">: </span><span style="color: #9CDCFE">manifestFilePath</span><span style="color: #D4D4D4">}) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> {</span><span style="color: #4FC1FF">root</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">dir</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">base</span><span style="color: #D4D4D4">} = </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">parse</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">manifestFilePath</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">              ...</span><span style="color: #9CDCFE">manifest</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">              </span><span style="color: #9CDCFE">[name </span><span style="color: #D4D4D4">+</span><span style="color: #9CDCFE"> </span><span style="color: #CE9178">&#39;-&#39;</span><span style="color: #9CDCFE"> </span><span style="color: #D4D4D4">+</span><span style="color: #9CDCFE"> base]:</span><span style="color: #D4D4D4"> {</span><span style="color: #9CDCFE">path:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">manifestFilePath</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">root</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">}</span></span>
<span class="line"><span style="color: #D4D4D4">            };</span></span>
<span class="line"><span style="color: #D4D4D4">          }, </span><span style="color: #9CDCFE">seed</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">        }</span></span>
<span class="line"><span style="color: #D4D4D4">      }),</span></span>
<span class="line"><span style="color: #D4D4D4">    );</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">configureWebpack</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">genPlugins</span><span style="color: #D4D4D4">(),</span></span>
<span class="line"><span style="color: #D4D4D4">  }) </span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span><br /><span
        class="line-number"
        >33</span
      ><br /><span class="line-number">34</span><br /><span class="line-number">35</span><br /><span
        class="line-number"
        >36</span
      ><br /><span class="line-number">37</span><br /><span class="line-number">38</span><br /><span
        class="line-number"
        >39</span
      ><br /><span class="line-number">40</span><br /><span class="line-number">41</span><br /><span
        class="line-number"
        >42</span
      ><br /></div></div
  ><h3 id="vue2-支持-composition-api-setup-写法" tabindex="-1"
    ><a class="header-anchor" href="#vue2-支持-composition-api-setup-写法" aria-hidden="true">#</a>
    Vue2 支持 composition-api/setup 写法</h3
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">defineConfig</span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;@vue/cli-service&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">ScriptSetup</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">require</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;unplugin-vue2-script-setup/webpack&#39;</span><span style="color: #D4D4D4">).</span><span style="color: #9CDCFE">default</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">isProd</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">.</span><span style="color: #4FC1FF">NODE_ENV</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">&#39;production&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">genPlugins</span><span style="color: #D4D4D4"> = () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">plugins</span><span style="color: #D4D4D4"> = [</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">ScriptSetup</span><span style="color: #D4D4D4">({})</span></span>
<span class="line"><span style="color: #D4D4D4">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #4EC9B0">module</span><span style="color: #D4D4D4">.</span><span style="color: #4EC9B0">exports</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #DCDCAA">configureWebpack</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> () </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> ({</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">genPlugins</span><span style="color: #D4D4D4">(),</span></span>
<span class="line"><span style="color: #D4D4D4">  }) </span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span
      ><br /></div></div
  ><p><code>package.json</code> 添加相关依赖</p>
  <div class="language-json ext-json line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #D4D4D4">{</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">&quot;dependencies&quot;</span><span style="color: #D4D4D4">: {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;@vue/composition-api&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">&quot;^1.4.6&quot;</span></span>
<span class="line"><span style="color: #D4D4D4">  },</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">&quot;devDependencies&quot;</span><span style="color: #D4D4D4">: {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;@vue/runtime-dom&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">&quot;^3.2.31&quot;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">&quot;unplugin-vue2-script-setup&quot;</span><span style="color: #D4D4D4">: </span><span style="color: #CE9178">&quot;^0.9.3&quot;</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /></div></div
  ><div class="custom-container warning"
    ><p class="custom-container-title">注意</p>
    <p
      ><a
        href="https://github.com/vuejs/composition-api/blob/main/README.zh-CN.md"
        target="_blank"
        rel="noopener noreferrer"
        >@vue/composition-api<ExternalLinkIcon
      /></a>
      是用于提供组合式 API 的 Vue 2 插件。支持所有现代浏览器以及IE11+。对于更低版本的 IE
      浏览器你需要安装 WeakMap polyfill (例如使用 core-js库)</p
    >
  </div>
  <h2 id="bundleless" tabindex="-1"
    ><a class="header-anchor" href="#bundleless" aria-hidden="true">#</a> bundleless</h2
  >
  <h3 id="配置路径别名-alias" tabindex="-1"
    ><a class="header-anchor" href="#配置路径别名-alias" aria-hidden="true">#</a> 配置路径别名
    alias</h3
  >
  <p><code>vite.config.js</code> 相关配置：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">defineConfig</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">loadEnv</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">wrapperEnv</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./build/vite/utils&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">resolve</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;path&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">pathResolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">__dirname</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&#39;.&#39;</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">(({ </span><span style="color: #9CDCFE">command</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> }) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">root</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">cwd</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">env</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">loadEnv</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">root</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// The boolean type read by loadEnv is a string. This function can be converted to boolean type</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">viteEnv</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">wrapperEnv</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">VITE_PORT</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_PUBLIC_PATH</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_PROXY</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_DROP_CONSOLE</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">resolve:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">alias:</span><span style="color: #D4D4D4"> [</span></span>
<span class="line"><span style="color: #D4D4D4">        {</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #6A9955">// @/xxxx  =&gt;  src/xxx</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">find:</span><span style="color: #D16969"> /</span><span style="color: #DCDCAA">^</span><span style="color: #D16969">@</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">replacement:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">pathResolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;./src&#39;</span><span style="color: #D4D4D4">) + </span><span style="color: #CE9178">&#39;/&#39;</span></span>
<span class="line"><span style="color: #D4D4D4">        },</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// #/xxxx =&gt; types/xxxx</span></span>
<span class="line"><span style="color: #D4D4D4">        {</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">find:</span><span style="color: #D16969"> /#</span><span style="color: #D7BA7D">\/</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">replacement:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">pathResolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;./types&#39;</span><span style="color: #D4D4D4">) + </span><span style="color: #CE9178">&#39;/&#39;</span></span>
<span class="line"><span style="color: #D4D4D4">        },</span></span>
<span class="line"><span style="color: #D4D4D4">        {</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">find:</span><span style="color: #D16969"> /</span><span style="color: #DCDCAA">^</span><span style="color: #D16969">utils/</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">replacement:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">pathResolve</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;node_modules/@winner-fed/cloud-utils/dist/cloud-utils.esm&#39;</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">        }</span></span>
<span class="line"><span style="color: #D4D4D4">      ]</span></span>
<span class="line"><span style="color: #D4D4D4">    },</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">});</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span><br /><span
        class="line-number"
        >33</span
      ><br /><span class="line-number">34</span><br /><span class="line-number">35</span><br /><span
        class="line-number"
        >36</span
      ><br /><span class="line-number">37</span><br /><span class="line-number">38</span><br /><span
        class="line-number"
        >39</span
      ><br /><span class="line-number">40</span><br /></div></div
  ><h3 id="配置代理-proxy-本地解决跨域问题" tabindex="-1"
    ><a class="header-anchor" href="#配置代理-proxy-本地解决跨域问题" aria-hidden="true">#</a>
    配置代理 Proxy，本地解决跨域问题</h3
  >
  <p><code>vite.config.js</code> 相关配置：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">defineConfig</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">loadEnv</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">wrapperEnv</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./build/vite/utils&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createProxy</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./build/vite/proxy&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">resolve</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;path&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">pathResolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">__dirname</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&#39;.&#39;</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">(({ </span><span style="color: #9CDCFE">command</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> }) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">root</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">cwd</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">env</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">loadEnv</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">root</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// The boolean type read by loadEnv is a string. This function can be converted to boolean type</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">viteEnv</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">wrapperEnv</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">VITE_PORT</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_PUBLIC_PATH</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_PROXY</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_DROP_CONSOLE</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">server:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">host:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;0.0.0.0&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">port:</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">VITE_PORT</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// Load proxy configuration from .env</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">proxy:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createProxy</span><span style="color: #D4D4D4">(</span><span style="color: #4FC1FF">VITE_PROXY</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">hmr:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">overlay:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    },</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">});</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /></div></div
  ><p>其中，<code>/build/vite/</code> 目录的 proxy.js 代码如下：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #6A9955">// proxy.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">httpsRE</span><span style="color: #D4D4D4"> =</span><span style="color: #D16969"> /</span><span style="color: #DCDCAA">^</span><span style="color: #D16969">https:</span><span style="color: #D7BA7D">\/\/</span><span style="color: #D16969">/</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">/**</span></span>
<span class="line"><span style="color: #6A9955"> * Generate proxy</span></span>
<span class="line"><span style="color: #6A9955"> * </span><span style="color: #569CD6">@param</span><span style="color: #6A9955"> </span><span style="color: #9CDCFE">list</span></span>
<span class="line"><span style="color: #6A9955"> */</span></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createProxy</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">ret</span><span style="color: #D4D4D4"> = {};</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #4EC9B0">Array</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">isArray</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">) &amp;&amp; </span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">.</span><span style="color: #9CDCFE">length</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">for</span><span style="color: #D4D4D4"> (</span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> [</span><span style="color: #4FC1FF">prefix</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">target</span><span style="color: #D4D4D4">] </span><span style="color: #569CD6">of</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">list</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">isHttps</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">httpsRE</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">test</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #6A9955">// https://github.com/http-party/node-http-proxy#options</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">ret</span><span style="color: #D4D4D4">[</span><span style="color: #9CDCFE">prefix</span><span style="color: #D4D4D4">] = {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">target:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">target</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">changeOrigin:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">ws:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #DCDCAA">rewrite</span><span style="color: #9CDCFE">:</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">replace</span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #4EC9B0">RegExp</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">`^</span><span style="color: #569CD6">${</span><span style="color: #9CDCFE">prefix</span><span style="color: #569CD6">}</span><span style="color: #CE9178">`</span><span style="color: #D4D4D4">), </span><span style="color: #CE9178">&#39;&#39;</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// https is require secure=false</span></span>
<span class="line"><span style="color: #D4D4D4">        ...(</span><span style="color: #9CDCFE">isHttps</span><span style="color: #D4D4D4"> ? { </span><span style="color: #9CDCFE">secure:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">false</span><span style="color: #D4D4D4"> } : {})</span></span>
<span class="line"><span style="color: #D4D4D4">      };</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">ret</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /></div></div
  ><p><code>VITE_PROXY</code> 是在根目录下的 <code>.env.development</code> 里定义的，如下：</p>
  <div class="language-bash ext-sh line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #6A9955"># Cross-domain proxy, you can configure multiple</span></span>
<span class="line"><span style="color: #D4D4D4">VITE_PROXY=[[</span><span style="color: #CE9178">&quot;/api&quot;</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">&quot;http://localhost:3000&quot;</span><span style="color: #D4D4D4">],[</span><span style="color: #CE9178">&quot;/upload&quot;</span><span style="color: #D4D4D4">,</span><span style="color: #CE9178">&quot;http://localhost:3001/upload&quot;</span><span style="color: #D4D4D4">]]</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /></div></div
  ><h3 id="使用-jsx或tsx" tabindex="-1"
    ><a class="header-anchor" href="#使用-jsx或tsx" aria-hidden="true">#</a> 使用 JSX或TSX</h3
  >
  <p
    ><a
      href="https://www.npmjs.com/package/@vitejs/plugin-vue-jsx"
      target="_blank"
      rel="noopener noreferrer"
      >@vitejs/plugin-vue-jsx<ExternalLinkIcon
    /></a>
    通过 HMR 提供 Vue 3 JSX 和 TSX 支持。</p
  >
  <p><code>vite.config.js</code> 配置</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">defineConfig</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">loadEnv</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">resolve</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;path&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createVitePlugins</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./build/vite/plugin&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createProxy</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./build/vite/proxy&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">wrapperEnv</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./build/vite/utils&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">pathResolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">__dirname</span><span style="color: #D4D4D4">, </span><span style="color: #CE9178">&#39;.&#39;</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">dir</span><span style="color: #D4D4D4">);</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// https://vitejs.dev/config/</span></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">(({ </span><span style="color: #9CDCFE">command</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> }) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">root</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">cwd</span><span style="color: #D4D4D4">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">env</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">loadEnv</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">root</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// The boolean type read by loadEnv is a string. This function can be converted to boolean type</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">viteEnv</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">wrapperEnv</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">env</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF">VITE_PORT</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_PUBLIC_PATH</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_PROXY</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_DROP_CONSOLE</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4"> } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">isBuild</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">command</span><span style="color: #D4D4D4"> === </span><span style="color: #CE9178">&#39;build&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// The vite plugin used by the project. The quantity is large, so it is separately extracted and managed</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins:</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createVitePlugins</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">),</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span
      ><br /></div></div
  ><p>其中，在使用 Vue3 时，<code>build/vite/plugin/</code> 目录的 index.js</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #6A9955">// build/vite/index.js</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">legacy</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;@vitejs/plugin-legacy&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vue</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;@vitejs/plugin-vue&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vueJsx</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;@vitejs/plugin-vue-jsx&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">svgLoader</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite-svg-loader&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createVitePlugins</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_USE_IMAGEMIN</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS_DELETE_ORIGIN_FILE</span></span>
<span class="line"><span style="color: #D4D4D4">  } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">vitePlugins</span><span style="color: #D4D4D4"> = [</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">vue</span><span style="color: #D4D4D4">(),</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">vueJsx</span><span style="color: #D4D4D4">(),</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">svgLoader</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #D4D4D4">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// @vitejs/plugin-legacy</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4"> &amp;&amp;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4"> &amp;&amp;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">legacy</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">targets:</span><span style="color: #D4D4D4"> [</span><span style="color: #CE9178">&#39;ie &gt;= 11&#39;</span><span style="color: #D4D4D4">],</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">additionalLegacyPolyfills:</span><span style="color: #D4D4D4"> [</span><span style="color: #CE9178">&#39;regenerator-runtime/runtime&#39;</span><span style="color: #D4D4D4">]</span></span>
<span class="line"><span style="color: #D4D4D4">    })</span></span>
<span class="line"><span style="color: #D4D4D4">  );</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span><br /><span
        class="line-number"
        >33</span
      ><br /><span class="line-number">34</span><br /></div></div
  ><p>在使用 Vue2 时，<code>build/vite/plugin/</code> 目录的 index.js</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">legacy</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;@vitejs/plugin-legacy&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createVuePlugin</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">as</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vue2</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite-plugin-vue2&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #6A9955">// @ts-ignore</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vueTemplateBabelCompiler</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vue-template-babel-compiler&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">scriptSetup</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;unplugin-vue2-script-setup/vite&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">svgLoader</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite-svg-loader&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createVitePlugins</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_USE_IMAGEMIN</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS_DELETE_ORIGIN_FILE</span></span>
<span class="line"><span style="color: #D4D4D4">  } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">vitePlugins</span><span style="color: #D4D4D4"> = [</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">vue2</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">jsx:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">vueTemplateOptions:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">compiler:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vueTemplateBabelCompiler</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }),</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">scriptSetup</span><span style="color: #D4D4D4">(),</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #DCDCAA">svgLoader</span><span style="color: #D4D4D4">()</span></span>
<span class="line"><span style="color: #D4D4D4">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// @vitejs/plugin-legacy</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4"> &amp;&amp;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4"> &amp;&amp;</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">legacy</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">targets:</span><span style="color: #D4D4D4"> [</span><span style="color: #CE9178">&#39;ie &gt;= 11&#39;</span><span style="color: #D4D4D4">],</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">additionalLegacyPolyfills:</span><span style="color: #D4D4D4"> [</span><span style="color: #CE9178">&#39;regenerator-runtime/runtime&#39;</span><span style="color: #D4D4D4">]</span></span>
<span class="line"><span style="color: #D4D4D4">      })</span></span>
<span class="line"><span style="color: #D4D4D4">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span><br /><span
        class="line-number"
        >33</span
      ><br /><span class="line-number">34</span><br /><span class="line-number">35</span><br /><span
        class="line-number"
        >36</span
      ><br /><span class="line-number">37</span><br /><span class="line-number">38</span><br /><span
        class="line-number"
        >39</span
      ><br /></div></div
  ><h3 id="less-全局注入变量及函数" tabindex="-1"
    ><a class="header-anchor" href="#less-全局注入变量及函数" aria-hidden="true">#</a> Less
    全局注入变量及函数</h3
  >
  <p><code>vite.config.js</code> 配置如下：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">defineConfig</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">loadEnv</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">// https://vitejs.dev/config/</span></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">defineConfig</span><span style="color: #D4D4D4">(({ </span><span style="color: #9CDCFE">command</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">mode</span><span style="color: #D4D4D4"> }) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">css:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">preprocessorOptions:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">less:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">additionalData:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">`@import &quot;@/assets/style/variable.less&quot;;@import &quot;@winner-fed/magicless/magicless.less&quot;;`</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">modifyVars:</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// Used for global import to avoid the need to import each style file separately</span></span>
<span class="line"><span style="color: #D4D4D4">            </span><span style="color: #6A9955">// reference:  Avoid repeated references</span></span>
<span class="line"><span style="color: #D4D4D4">          },</span></span>
<span class="line"><span style="color: #D4D4D4">          </span><span style="color: #9CDCFE">javascriptEnabled:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span></span>
<span class="line"><span style="color: #D4D4D4">        }</span></span>
<span class="line"><span style="color: #D4D4D4">      }</span></span>
<span class="line"><span style="color: #D4D4D4">    }</span></span>
<span class="line"><span style="color: #D4D4D4">  };</span></span>
<span class="line"><span style="color: #D4D4D4">});</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span
      ><br /></div></div
  ><h3 id="支持-gzip-压缩-1" tabindex="-1"
    ><a class="header-anchor" href="#支持-gzip-压缩-1" aria-hidden="true">#</a> 支持 gzip 压缩</h3
  >
  <p
    >使用
    <a
      href="https://github.com/vbenjs/vite-plugin-compression"
      target="_blank"
      rel="noopener noreferrer"
      >vite-plugin-compression<ExternalLinkIcon
    /></a>
    插件实现。</p
  >
  <p><code>build/vite/plugin/index.js</code> 配置如下:</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">configCompressPlugin</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./compress&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createVitePlugins</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_USE_IMAGEMIN</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS_DELETE_ORIGIN_FILE</span></span>
<span class="line"><span style="color: #D4D4D4">  } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">vitePlugins</span><span style="color: #D4D4D4"> = [];</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// The following plugins only work in the production environment</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// rollup-plugin-gzip</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">configCompressPlugin</span><span style="color: #D4D4D4">(</span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS</span><span style="color: #D4D4D4">, </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS_DELETE_ORIGIN_FILE</span><span style="color: #D4D4D4">)</span></span>
<span class="line"><span style="color: #D4D4D4">    );</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span
      ><br /></div></div
  ><p><code>build/vite/plugin/compress.js</code> 如下：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #6A9955">/**</span></span>
<span class="line"><span style="color: #6A9955"> * Used to package and output gzip. Note that this does not work properly in Vite, the specific reason is still being investigated</span></span>
<span class="line"><span style="color: #6A9955"> */</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">compressPlugin</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite-plugin-compression&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">configCompressPlugin</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// &#39;gzip&#39; | &#39;brotli&#39; | &#39;none&#39;</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">compress</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">deleteOriginFile</span><span style="color: #D4D4D4"> = </span><span style="color: #569CD6">false</span></span>
<span class="line"><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">compressList</span><span style="color: #D4D4D4"> = </span><span style="color: #9CDCFE">compress</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">split</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;,&#39;</span><span style="color: #D4D4D4">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">plugins</span><span style="color: #D4D4D4"> = [];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">compressList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;gzip&#39;</span><span style="color: #D4D4D4">)) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">compressPlugin</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">ext:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;.gz&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">deleteOriginFile</span></span>
<span class="line"><span style="color: #D4D4D4">      })</span></span>
<span class="line"><span style="color: #D4D4D4">    );</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #9CDCFE">compressList</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">includes</span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">&#39;brotli&#39;</span><span style="color: #D4D4D4">)) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #DCDCAA">compressPlugin</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">ext:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;.br&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">algorithm:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;brotliCompress&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">        </span><span style="color: #9CDCFE">deleteOriginFile</span></span>
<span class="line"><span style="color: #D4D4D4">      })</span></span>
<span class="line"><span style="color: #D4D4D4">    );</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">plugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /><span class="line-number">19</span><br /><span class="line-number">20</span><br /><span
        class="line-number"
        >21</span
      ><br /><span class="line-number">22</span><br /><span class="line-number">23</span><br /><span
        class="line-number"
        >24</span
      ><br /><span class="line-number">25</span><br /><span class="line-number">26</span><br /><span
        class="line-number"
        >27</span
      ><br /><span class="line-number">28</span><br /><span class="line-number">29</span><br /><span
        class="line-number"
        >30</span
      ><br /><span class="line-number">31</span><br /><span class="line-number">32</span><br /><span
        class="line-number"
        >33</span
      ><br /><span class="line-number">34</span><br /></div></div
  ><h3 id="构建包依赖分析" tabindex="-1"
    ><a class="header-anchor" href="#构建包依赖分析" aria-hidden="true">#</a> 构建包依赖分析</h3
  >
  <p
    >使用
    <a
      href="https://github.com/btd/rollup-plugin-visualizer"
      target="_blank"
      rel="noopener noreferrer"
      >rollup-plugin-visualizer<ExternalLinkIcon
    /></a>
    插件实现。</p
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">configVisualizerConfig</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./visualizer&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createVitePlugins</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_USE_IMAGEMIN</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS_DELETE_ORIGIN_FILE</span></span>
<span class="line"><span style="color: #D4D4D4">  } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">vitePlugins</span><span style="color: #D4D4D4"> = [];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// vite-plugin-svg-icons</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">configVisualizerConfig</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">));</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span
      ><br /></div></div
  ><p><code>build/vite/plugin/visualizer.js</code> 如下：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #6A9955">/**</span></span>
<span class="line"><span style="color: #6A9955"> * Package file volume analysis</span></span>
<span class="line"><span style="color: #6A9955"> */</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">visualizer</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;rollup-plugin-visualizer&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">isReportMode</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;../utils&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">configVisualizerConfig</span><span style="color: #D4D4D4">() {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">if</span><span style="color: #D4D4D4"> (</span><span style="color: #DCDCAA">isReportMode</span><span style="color: #D4D4D4">()) {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">visualizer</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">filename:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./node_modules/.cache/visualizer/stats.html&#39;</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">      </span><span style="color: #9CDCFE">open:</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">true</span></span>
<span class="line"><span style="color: #D4D4D4">    });</span></span>
<span class="line"><span style="color: #D4D4D4">  }</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> [];</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /></div></div
  ><h3 id="svg-雪碧图" tabindex="-1"
    ><a class="header-anchor" href="#svg-雪碧图" aria-hidden="true">#</a> SVG 雪碧图</h3
  >
  <p
    >使用
    <a
      href="https://github.com/vbenjs/vite-plugin-svg-icons"
      target="_blank"
      rel="noopener noreferrer"
      >vite-plugin-svg-icons<ExternalLinkIcon
    /></a>
    插件实现。</p
  >
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">configSvgIconsPlugin</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;./svgSprite&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">createVitePlugins</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> {</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_USE_IMAGEMIN</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_LEGACY</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #4FC1FF">VITE_BUILD_COMPRESS_DELETE_ORIGIN_FILE</span></span>
<span class="line"><span style="color: #D4D4D4">  } = </span><span style="color: #9CDCFE">viteEnv</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">vitePlugins</span><span style="color: #D4D4D4"> = [];</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #6A9955">// vite-plugin-svg-icons</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">push</span><span style="color: #D4D4D4">(</span><span style="color: #DCDCAA">configSvgIconsPlugin</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">));</span></span>
<span class="line"><span style="color: #D4D4D4">  </span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">vitePlugins</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span
      ><br /></div></div
  ><p><code>build/vite/plugin/svgSprite.js</code> 如下：</p>
  <div class="language-javascript ext-js line-numbers-mode">
    <pre
      v-pre
      class="shiki"
      style="background-color: #1e1e1e"
    ><code><span class="line"><span style="color: #6A9955">/**</span></span>
<span class="line"><span style="color: #6A9955"> * Vite Plugin for fast creating SVG sprites.</span></span>
<span class="line"><span style="color: #6A9955"> * https://github.com/vbenjs/vite-plugin-svg-icons</span></span>
<span class="line"><span style="color: #6A9955"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE">createSvgIconsPlugin</span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;vite-plugin-svg-icons&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;path&#39;</span><span style="color: #D4D4D4">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">function</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA">configSvgIconsPlugin</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">) {</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> </span><span style="color: #4FC1FF">svgIconsPlugin</span><span style="color: #D4D4D4"> = </span><span style="color: #DCDCAA">createSvgIconsPlugin</span><span style="color: #D4D4D4">({</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">iconDirs:</span><span style="color: #D4D4D4"> [</span><span style="color: #9CDCFE">path</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">resolve</span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE">process</span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA">cwd</span><span style="color: #D4D4D4">(), </span><span style="color: #CE9178">&#39;src/icons/svg&#39;</span><span style="color: #D4D4D4">)],</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">svgoOptions:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">isBuild</span><span style="color: #D4D4D4">,</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #6A9955">// default</span></span>
<span class="line"><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE">symbolId:</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&#39;icon-[dir]-[name]&#39;</span></span>
<span class="line"><span style="color: #D4D4D4">  });</span></span>
<span class="line"><span style="color: #D4D4D4">  </span><span style="color: #C586C0">return</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE">svgIconsPlugin</span><span style="color: #D4D4D4">;</span></span>
<span class="line"><span style="color: #D4D4D4">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre
    ><div class="line-numbers" aria-hidden="true"
      ><span class="line-number">1</span><br /><span class="line-number">2</span><br /><span
        class="line-number"
        >3</span
      ><br /><span class="line-number">4</span><br /><span class="line-number">5</span><br /><span
        class="line-number"
        >6</span
      ><br /><span class="line-number">7</span><br /><span class="line-number">8</span><br /><span
        class="line-number"
        >9</span
      ><br /><span class="line-number">10</span><br /><span class="line-number">11</span><br /><span
        class="line-number"
        >12</span
      ><br /><span class="line-number">13</span><br /><span class="line-number">14</span><br /><span
        class="line-number"
        >15</span
      ><br /><span class="line-number">16</span><br /><span class="line-number">17</span><br /><span
        class="line-number"
        >18</span
      ><br /></div></div
></template>
